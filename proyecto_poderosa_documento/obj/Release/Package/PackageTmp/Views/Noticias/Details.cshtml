@model proyecto_poderosa_documento.Models.Noticia
@{
    var imagenesCarruselList = Model.ImagenesCarrusel?.Split(new[] { ',' }, StringSplitOptions.RemoveEmptyEntries).ToList();
    ViewBag.Title = "Detalles de la Noticia";
}
@{
    Layout = "~/Views/Shared/_CustomLayout.cshtml";
}
@Html.Partial("~/Views/Shared/_head.cshtml")

<title>@System.Text.RegularExpressions.Regex.Replace(Model.Titulo.Normalize(System.Text.NormalizationForm.FormD), @"[^a-zA-Z0-9\s]", "") | PODEROSA</title>
<meta name="title" content="@System.Text.RegularExpressions.Regex.Replace(Model.Titulo.Normalize(System.Text.NormalizationForm.FormD), @"[^a-zA-Z0-9\s]", "") | PODEROSA" />
<meta name="description" content="@System.Text.RegularExpressions.Regex.Replace(Model.Descripcion.Normalize(System.Text.NormalizationForm.FormD), @"[^a-zA-Z0-9\s,\.áéíóúÁÉÍÓÚñÑ]", "")" />
<meta name="url" content="@($"{Request.Url.Scheme}://{Request.Url.Authority}{Url.Action("Details", "Noticias", new { slug = Model.Slug })}")" />
<meta name="keywords" content="Poderosa, Minería, Noticias, @System.Text.RegularExpressions.Regex.Replace(Model.Titulo.Normalize(System.Text.NormalizationForm.FormD), @"[^a-zA-Z0-9\s,áéíóúÁÉÍÓÚñÑ]", "")" />

<meta property="og:type" content="website" />
<meta property="og:title" content="@System.Text.RegularExpressions.Regex.Replace(Model.Titulo.Normalize(System.Text.NormalizationForm.FormD), @"[^a-zA-Z0-9\s]", "") | PODEROSA" />
<meta property="og:description" content="@System.Text.RegularExpressions.Regex.Replace(Model.Descripcion.Normalize(System.Text.NormalizationForm.FormD), @"[^a-zA-Z0-9\s,\.áéíóúÁÉÍÓÚñÑ]", "")" />
<meta property="og:url" content="@($"{Request.Url.Scheme}://{Request.Url.Authority}{Url.Action("Details", "Noticias", new { slug = Model.Slug })}")" />
<meta property="og:image" content="https://www.poderosa.com.pe/content/noticias/comparti/@System.IO.Path.GetFileName(Model.ImagenesCompartir)">

</head>
<body>
    <div class="menuSecuVelo"></div>
    @Html.Partial("~/Views/Shared/_header.cshtml")
    <!-- Banner de la noticia -->
    <section class="pt-4">
        <div class="noticias-banner">
            <div class="bg-gris-oscuro-4">
                <h1 class="fuente-3 noticias-banner-texto">
                    @Model.Titulo
                </h1>
            </div>
            <div class="noticia-banner-img">
                <!-- Mostrar la imagen si existe -->
                @if (!string.IsNullOrEmpty(Model.Imagen))
                {
                    <img src="@Url.Content(Model.Imagen)" alt="@Model.Titulo" class="img-fluid">
                }
            </div>
        </div>
        <div class="noticia-container">
            <div class="noticia-container-texto">
                <div>
                    <h6 class="mayuscula mt-4 fuente-3">
                        @{
                            var fechaPublicacion = Model.FechaPublicacion.ToString("dd 'de' MMMM 'de' yyyy", new System.Globalization.CultureInfo("es-ES"));
                            var partesFecha = fechaPublicacion.Split(' ');
                            var fechaConMesMayusculas = $"{partesFecha[0]} {partesFecha[1]} {partesFecha[2].ToUpper()} {partesFecha[3]} {partesFecha[4]}";
                        }
                        @fechaConMesMayusculas
                    </h6>
                </div>
                <h2 class="fuente-3 dorado">@Model.Descripcion</h2>
                <!-- Mostrar contenido con formato HTML -->
                <div>@Html.Raw(Model.Contenido)</div>  <!-- Usar Html.Raw para mostrar el contenido con formato -->
            </div>
            @if (imagenesCarruselList != null && imagenesCarruselList.Any())
            {
                <section class="position-relative py-5">
                    <div class="container-custom2">
                        <div class="row ">
                            <div class="col-12  col-xxl-12">
                                <div id="carousel-items" class="carousel slide">
                                    <div class="carousel-inner">
                                        @for (int i = 0; i < imagenesCarruselList.Count; i += 2)
                                        {
                                            <div class="carousel-item @(i == 0 ? "active" : "")">
                                                <div class="row">
                                                    <div class="col-12 col-sm-6 mb-3">
                                                        <img src="@Url.Content(imagenesCarruselList.ElementAt(i))" class="img-fluid" alt="...">
                                                    </div>
                                                    @if (i + 1 < imagenesCarruselList.Count)
                                                    {
                                                        <div class="col-12 col-sm-6 mb-3">
                                                            <img src="@Url.Content(imagenesCarruselList.ElementAt(i + 1))" class="img-fluid" alt="...">
                                                        </div>
                                                    }
                                                </div>
                                            </div>
                                        }
                                    </div>
                                    <div class="d-flex pt-4 pt-sm-0 pb-4 justify-content-center">
                                        <button class="carousel-control-prev" type="button" data-bs-target="#carousel-items" data-bs-slide="prev">
                                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                            <span class="visually-hidden">Previous</span>
                                        </button>
                                        <button class="carousel-control-next" type="button" data-bs-target="#carousel-items" data-bs-slide="next">
                                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                            <span class="visually-hidden">Next</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            }
        </div>
    </section>
    <br>
    <div class="d-flex justify-content-center mt-1">
        <div class="d-flex align-items-center gap-2">
            <p class="mb-2 text-center">Comparte en:</p>
            @Html.Partial("~/Views/Shared/_redes.cshtml")
        </div>
    </div>
    <section class=" py-5">
        <div class="container">
            <div class="contenedor-noticias py-5">
                <div class="contenedor-noticias-titulo pb-3">
                    <h1 class="fuente-3">
                        Lo último
                    </h1>
                    <a href="@Url.Action("Index", "Noticias")" class="fuente-5 button-ver-mas d-flex align-items-center">
                        Ver más noticias <img src="~/Content/img/home/icono.svg" alt="" class="icono img-fluid">
                    </a>
                </div>
                <div class="row">
                    @if (ViewBag.UltimasNoticias != null)
                    {
                        foreach (var noticia in ViewBag.UltimasNoticias)
                        {
                            <div class="col-12 col-md-6 col-lg-4 mb-5">
                                <a href="@Url.Action("Details", "Noticias", new { slug = noticia.Slug })" class="text-decoration-none">
                                    <!-- Imagen de resumen -->
                                    @if (!string.IsNullOrEmpty(noticia.ImagenResumen))
                                    {
                                        <img src="@Url.Content(noticia.ImagenResumen)" alt="@noticia.Titulo" class="img-fluid contenedor-noticias-img zoom-img">
                                    }
                                    <h5 class="fuente-3 mt-2">
                                        @noticia.Titulo
                                    </h5>
                                </a>
                                <p class="fuente-4">
                                    @{
                                        var descripcion = noticia.Descripcion;
                                        var displayDescripcion = descripcion.Length > 150 ? descripcion.Substring(0, 150) + "..." : descripcion;
                                    }
                                    @displayDescripcion
                                </p>
                            </div>
                        }
                    }
                </div>

            </div>
        </div>
    </section>
    @Html.Partial("~/Views/Shared/_footer.cshtml")
</body>
@Html.Partial("~/Views/Shared/_foot.cshtml")
</html>
